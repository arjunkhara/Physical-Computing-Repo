<h1>Arduino Puzzle Box</h1>

<h3>PUZZLE BOX: INTRODUCTION</h3>
The Puzzle Box is a mid-term challenge to assess two criteria: (1) how much of Arduino and physical computing have students learned; (2) willingness to step beyond comfort zones and test learnings by building a puzzle box with familiar and unfamiliar components, the latter requiring self-initiative and exploration. I was quite excited, if also apprehensive, about this assignment, but I felt the result had a distinctive and somewhat whimsical quality that invited conversations and further questions from all who saw it. I ended up building a force-driven puzzle box with LEDs, Piezo speaker, accelerometer, sound sensor, servo motors, two Arduino boards, laser-cut box with polarisation properties, and an overarching theme from Star Wars. The following entry documents this week’s topics and processes. The accompanying blog entries detail my thoughts, insights, analysis, and code blocks + recommendations (where feasible) on the week’s topic(s). References and bibliographies for all sourced and cited content has been provided at the end of this page. Note: The references made to Star Wars themes and related items have been used here strictly for educational and personal project purposes only, and are not intended for commercial or official use of any kind whatsoever. Nothing in this project is endorsed or sponsored by the Star Wars brand.

<h3>PUZZLE BOX: ESSENCE</h3>
The essence of this puzzle box is to tilt the box along different axes and listen to each tone that plays. For those who are familiar with Star Wars, the clue easily suffices. The addition of the laser-cut Darth Vader head in the front of the box is probably a dead giveaway. For people with hearing disabilities, I also integrated a lighting system to indicate the combination. When the tones are played in the correct order, and all three LEDs light up, the box opens. However, to counter this easiness for those without impairment, I used a particular colour of acrylic for my box. Orange has a polarising effect on blue LEDs, the last one required to open the box. Therefore while the box is transparent, there is no way to tell whether the blue LED is on or off just by looking at it, since the orange acrylic cuts out the blue emission. This makes it more of a challenge to open the box. The result is a puzzle box that uses the force of light, the force of sound, the force of planetary spin, and “the Force” or instinct to open.

<h3>PUZZLE BOX: INSPIRATION</h3>
Having covered LEDs, buttons, and speakers quite extensively in the first few weeks, I decided to create a theme for my project along forces and energy. Essentially the LEDs are light energy, and speakers are sound energy. This gave me an idea for using “the Force” to open the box. From the various components I considered and experimented with, the accelerometer held most utility, which gave rise to the thinking: how cool would it be to use the Earth’s spin to open a puzzle box? Plus the idea of tying in the project with a favourite show was appealing enough to title the project, ‘Use the M•A’. In this instance the M•A serves as both the qualification of this masters as well as the elements of Newton’s famous equation: Force (F) = Mass (M) x Acceleration (A). Combining an accelerometer with Star Wars made perfect sense. However, I also wanted to create a box that would serve a purpose beyond just opening and closing, which I figured would get stale quite quickly, no matter how appealing the initial process of opening the box might be.

<h3>PUZZLE BOX: ACCELEROMETER</h3>
I set out to first build the circuitry for the accelerometer. Figuring out how the physics of how an accelerometer worked was fairly straightforward. The challenges came from learning how to code, attach, and update the libraries and scripts for the accelerometer, then orienting the device’s code and physical structure to produce readouts that were useful and accurate enough to cause conditional behaviour. I consulted several more sources than initially anticipated, all of which have been included in the reference section below. Briefly, the accelerometer has six degrees of freedom along the axes it moves. Each movement produces a value of motion. Perhaps the most amazing thing about the accelerometer is how these values are produced. An accelerometer works of tiny capacitance changes when the device is moved along the X, Y, and Z axes, in relation to the spin-charge of the rotating Earth. These changes are what is measured in the values produced. In other words, an accelerometer uses the spinning of the Earth and its resultant changes in orientation, which produce minute voltage differences, to effect orientation. By moving the accelerometer and generating these values, I was able to harness these differences from the Earth’s spin and use them to cause other actions. This device was literally using the force of the Earth, which is amazing to think about.

<h3>PUZZLE BOX: PIEZO SPEAKER AND NOTES</h3>
Once I was able to integrate all the libraries and scripts into the programme, I needed to create booleans and conditionals for these values to work with the LEDs and Piezo speaker. I setup the code such that a tilt along the X axis lights up an LED and plays a particular note, while tilting it along the Y and Z axes causes other LEDs and notes to activate. Once I had figured out the accelerometer’s six axes of freedom, I focused on making LEDs and speaker. Lighting up the LEDs was quite straightforward. The Piezo, however, posed plenty of opportunities, limited only by the Arduino’s internal 64K memory. Fortunately, the Imperial March theme from Star Wars only has three notes: F, C, and A. Once I integrated the Piezo library and assigned the tone, the Piezo played each note depending on where and how the box with the accelerometer was tilted. The challenge came from having the Piezo play each note for as long as I needed it to, followed by stops of appropriate duration. More research led to discovering the that the tone function took more than one parameter: it also took frequency and pause. Once I had this settled, the Piezo played each tone perfectly. Plus, when the box lid opened, the speaker played the entire bar from of the Imperial March, the reward for figuring out the combination of tilts and motion.

<h3>PUZZLE BOX: LEDS</h3>
I used LEDs as conditional statements to instruct the servos to turn, since the tones played by the Piezo were of insufficient analog output for the Arduino sensors to pick up straightaway, and initial tests of sound as a condition to operate the servos proved unreliable. LEDs on the other hand worked perfectly and drove the conditions to operate the servos to open the box. The orange acrylic did a fine job of cutting out the blue wavelength, which added an additional twist to the puzzle.

<h3>PUZZLE BOX: SERVOS</h3>
I initially though of using the servo motors as locks pushed through a slit in the box and spun perpendicular to act as a door jam, but then noticed that servo arms are incredibly difficult to turn without the correct command and source of power. I therefore decided to hack the servo as a hinged lifting device, that raised the lid of the box like a submarine hatch. This required the use of two servo motors, since one was not strong enough. And this caused additional challenges. Because both servos had to lift at exactly the right time, both had to be programmed with identical code. This seemed easy enough, till it came to the construction of the box mechanics. In order to lift the lid, the servos had to be placed on either side of the box, arms facing each other.This meant that if both servos were fed the same code, they would turn synchronously, each opposing the spin of the other; one would push up, the other pull down and the lid would break. As a result, I had to programme the servos to perform opposite functions, which added a significant level of complexity to the project, because the angles and turn speeds on each servo vary in tiny degrees from others. With some trial and error and the addition of the servo library, I was able to figure out the best combination of asynchronous turn directions and finally got the servos to work in tandem with each other. The result was a lid that lifted like a hatch when the box tilted, the LEDs lit up, and the Piezo sounded.

<h3>PUZZLE BOX: SOUND SENSOR</h3>
Once the basic mechanism of the box was sorted, I wanted to give the project utility beyond the classroom, by creating something I could use repeatedly. I was still intrigued by the idea of Star Wars, and so, after creating the Darth Vader mask, I decided to use two red LEDs as eyes, with the initial intention of getting them to flash when the box opened. However, the Piezo playing the Imperial March was adequate, and I wanted the eyes to flash independent of the box opening and closing. I therefore looked into using a sound sensor that caused the red LEDs to flash according to music. The process required not just setting up the sound sensor and library, but tuning it physically (with the built-in potentiometer) and through code by setting a threshold that was suitable for both, the sound sensor as well as the ambient noise gain. After a lot of trial and error, I was able to figure out the threshold (i.e. 80 worked best, 79 did not work at all, and 81 was overkill). The result was quite frankly spectacular, perhaps even more exciting than figuring out the accelerometer. The lights in Darth Vader’s eyes flashed in response and time to music of any scale, but particularly to voice-driven songs, a nice, unintended side effect. When placed next to a speaker, the puzzle box almost appears to come alive with an in-built force, another happy theme from Star Wars.

